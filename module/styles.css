/* Tipografías: terror legible (títulos) + serif legible (cuerpo) */
@import url("https://fonts.googleapis.com/css2?family=Special+Elite&family=Cormorant+Garamond:wght@400;600;700&display=swap");

.ragnarok.sheet {
  font-family: "Cormorant Garamond", Georgia, serif;
  background: var(--color-bg);
  color: #eee;
  padding: 12px;
  line-height: 1.25;

  /* Variables de tema para reutilización y mantenimiento */
  --color-bg: #0f0f0f;
  --color-surface: #151515;
  --color-surface-2: #161616;
  --color-border: #2a2a2a;
  --color-border-muted: #2f2f2f;
  --color-text: #f2f2f2;
  --color-text-subtle: #bfbfbf;
  --color-accent: #e74c3c;
  --color-accent-weak: rgba(231, 76, 60, 0.35);
  --color-accent-shadow: rgba(231, 76, 60, 0.08);
  --radius-sm: 4px;
  --radius-md: 6px;
  --gap-xs: 4px;
  --gap-sm: 6px;
  --gap-md: 8px;
  --gap-lg: 10px;
  --gap-xl: 12px;
}

/* Títulos */
.ragnarok.sheet h3 {
  font-family: "Special Elite", "Cormorant Garamond", Georgia, serif;
  color: var(--color-accent);
  margin: 0 0 8px 0;
  letter-spacing: 0.5px;
  text-shadow: 0 0 4px var(--color-accent-weak);
  text-align: left;
}
.ragnarok.sheet h2 {
  font-family: "Special Elite", "Cormorant Garamond", Georgia, serif;
  color: var(--color-accent);
  margin: 0 0 8px 0;
  letter-spacing: 0.5px;
  text-shadow: 0 0 4px var(--color-accent-weak);
  text-align: center;
}

/* Tarjetas/secciones */
.ragnarok.sheet .card {
  background: var(--color-surface-2);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  padding: 10px;
  margin-bottom: 12px;
  box-shadow: 0 0 8px var(--color-accent-shadow);
}

/* Grid base y variantes adaptables */
/* Grid base y variantes adaptables */
.ragnarok.sheet .grid {
  display: grid;
  gap: var(--gap-sm) var(--gap-lg);
  align-items: center;
  margin-bottom: 4px;
}
/* Dos columnas: etiqueta fija + control fluido a todo el ancho */
.ragnarok.sheet .grid.grid-tight {
  grid-template-columns: 120px 1fr;
}
@media (min-width: 520px) {
  .ragnarok.sheet .grid.grid-tight {
    grid-template-columns: 140px 1fr;
  }
}

/* Variables base (añadir en el scope si no existen) */
.ragnarok.sheet {
  --dif-progress: 0; /* 0..1 => 0 verde, 1 rojo */
}

/* Estilizado del range para ocupar todo el ancho y mostrar progreso */
.ragnarok.sheet input[type="range"] {
  width: 100%;
  height: 8px;
  margin: 0;
  background:
    linear-gradient(to right, #2ecc71, #e74c3c) 0 0 / calc(var(--dif-progress, 0) * 100%) 100% no-repeat,
    #343434;
  border-radius: var(--radius-sm);
  outline: none;
  -webkit-appearance: none;
  appearance: none;
}
.ragnarok.sheet input[type="range"]::-webkit-slider-runnable-track {
  height: 8px;
  background: transparent;
  border-radius: var(--radius-sm);
}
.ragnarok.sheet input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 16px;
  height: 16px;
  background: #ffffff;
  border: 2px solid var(--color-accent);
  border-radius: 50%;
  margin-top: -4px; /* centra el pulgar sobre el track */
  box-shadow: 0 0 6px var(--color-accent-weak);
  cursor: pointer;
}
.ragnarok.sheet input[type="range"]::-moz-range-track {
  height: 8px;
  background: #343434;
  border-radius: var(--radius-sm);
}
.ragnarok.sheet input[type="range"]::-moz-range-progress {
  height: 8px;
  background: linear-gradient(to right, #2ecc71, #e74c3c);
  border-radius: var(--radius-sm);
}
.ragnarok.sheet input[type="range"]::-moz-range-thumb {
  width: 16px;
  height: 16px;
  background: #ffffff;
  border: 2px solid var(--color-accent);
  border-radius: 50%;
  box-shadow: 0 0 6px var(--color-accent-weak);
  cursor: pointer;
}

/* Etiqueta de dificultad: color dinámico de verde a rojo según --dif-progress */
.ragnarok.sheet .dif-label {
  margin-top: 4px;
  font-size: 0.95em;
  color: hsl(calc((1 - var(--dif-progress, 0)) * 120) 70% 70%);
  transition: color 120ms ease-out;
}


/* Dos columnas: etiqueta + control */
.ragnarok.sheet .grid.grid-tight {
  grid-template-columns: 1fr 110px;
}
@media (min-width: 520px) {
  .ragnarok.sheet .grid.grid-tight {
    grid-template-columns: 1fr 130px;
  }
}

/* Etiquetas con alto contraste */
.ragnarok.sheet label {
  font-weight: 700;
  color: var(--color-text);
}

/* Inputs y selects: legibles en oscuro */
.ragnarok.sheet input[type="number"],
.ragnarok.sheet select {
  width: 100%;
  box-sizing: border-box;
  background: #101010;
  color: #f5f5f5;
  border: 1px solid #343434;
  border-radius: var(--radius-sm);
  padding: 4px 6px;
  min-height: 26px;
}
.ragnarok.sheet input[type="number"]::placeholder {
  color: var(--color-text-subtle);
}

/* Foco accesible y temático */
.ragnarok.sheet input[type="number"]:focus,
.ragnarok.sheet select:focus {
  outline: none;
  border-color: var(--color-accent);
  box-shadow: 0 0 6px var(--color-accent-weak);
}

/* Opciones del select: forzar contraste en menús */
.ragnarok.sheet select option {
  color: var(--color-bg);
  background: #f7f7f7;
}

/* Nombres de habilidades: clickables y con buen contraste */
.ragnarok.sheet .skill-name {
  cursor: pointer;
  text-decoration: underline dotted;
  color: #ffd9d9;
}
.ragnarok.sheet .skill-name:hover {
  text-decoration: underline;
  color: #ffffff;
}

/* Separadores sutiles dentro de tarjetas (opcional) */
.ragnarok.sheet .card + .card {
  border-top-color: var(--color-border-muted);
}

/* Bloque atributos + retrato */
.ragnarok.sheet .atts3x3 {
  display: grid;
  grid-template-columns: 1fr 1fr 170px; /* 2 columnas para atributos + 1 para imagen */
  gap: var(--gap-lg) var(--gap-xl);
  align-items: start;
}

/* Contenedor de atributos: 2 columnas (cada celda = 1 atributo) */
.ragnarok.sheet .atts3x3-attrs {
  grid-column: 1 / span 2;
  display: grid;
  grid-template-columns: 1fr 1fr; /* 2 columnas x n filas => 6 atributos = 3 filas */
  gap: var(--gap-lg) var(--gap-xl);
}

/* Cada celda de atributo: etiqueta arriba, input debajo */
.ragnarok.sheet .attr-cell {
  display: grid;
  grid-template-rows: auto auto;
  gap: var(--gap-xs);
}

/* Imagen ocupando la tercera columna y toda la altura visual del bloque */
.ragnarok.sheet .atts3x3-img {
  grid-column: 3 / 4;
  align-self: start;
  justify-self: center;
}

/* Retrato editable */
.ragnarok.sheet .actor-portrait {
  width: 160px;
  height: 160px;
  object-fit: cover;
  border: 2px solid var(--color-border);
  border-radius: var(--radius-md);
  box-shadow: 0 0 8px rgba(231, 76, 60, 0.15);
  cursor: pointer; /* indica que se puede editar (data-edit="img") */
}

/* Responsivo: en pantallas estrechas, apilar imagen debajo */
@media (max-width: 560px) {
  .ragnarok.sheet .atts3x3 {
    grid-template-columns: 1fr; /* una sola columna */
  }
  .ragnarok.sheet .atts3x3-attrs {
    grid-column: 1 / -1;
    grid-template-columns: 1fr; /* atributos en una columna */
  }
  .ragnarok.sheet .atts3x3-img {
    grid-column: 1 / -1;
    justify-self: start;
  }
  .ragnarok.sheet .actor-portrait {
    width: 100%;
    height: auto;
    max-width: 260px;
  }
}

.ragnarok.sheet .dif-label {
  margin-top: 4px;
  font-size: 0.95em;
  color: #ffd9d9;
}

/* =========================
   Pestañas de habilidades
   ========================= */
.ragnarok.sheet .skills-tabs {
  position: sticky;
  top: 0;
  z-index: 5;
  background: var(--color-bg);
  padding-bottom: var(--gap-sm);
  margin-bottom: var(--gap-md);
  border-bottom: 1px solid var(--color-border);
  display: grid;
  grid-auto-flow: column;
  grid-auto-columns: 1fr; /* cada pestaña ocupa el mismo ancho => total 100% */
  gap: var(--gap-sm);
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}
.ragnarok.sheet .skills-tab {
  list-style: none;
}
.ragnarok.sheet .skills-tab a,
.ragnarok.sheet .skills-tab button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  padding: 8px 10px;
  font-weight: 700;
  color: var(--color-text);
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-bottom-color: var(--color-border);
  border-radius: var(--radius-sm);
  text-decoration: none;
  cursor: pointer;
  white-space: nowrap;
}
.ragnarok.sheet .skills-tab a:hover,
.ragnarok.sheet .skills-tab button:hover {
  border-color: var(--color-accent);
  box-shadow: 0 0 6px var(--color-accent-weak);
}
.ragnarok.sheet .skills-tab.is-active a,
.ragnarok.sheet .skills-tab.is-active button,
.ragnarok.sheet .skills-tab a[aria-current="page"] {
  color: #fff;
  background: linear-gradient(to bottom, rgba(231, 76, 60, 0.15), transparent 60%);
  border-color: var(--color-accent);
}

/* Soporte opcional por anclas (:target) si cada bloque tiene un id (p. ej. #attr-INT) */
.ragnarok.sheet .skills-cell[id] {
  scroll-margin-top: 56px; /* deja espacio bajo la barra sticky */
}
.ragnarok.sheet .skills-tab a[href^="#"]:is(:focus, :hover) {
  text-decoration: underline;
}

/* =========================
   Cuadrícula de habilidades
   ========================= */
/* Malla 3x2 para habilidades agrupadas por atributo */
.ragnarok.sheet .skills-grid-3x2 {
  display: grid;
  grid-template-columns: repeat(2, 1fr); /* base: 2 columnas */
  gap: var(--gap-xl);
}
@media (max-width: 640px) {
  .ragnarok.sheet .skills-grid-3x2 {
    grid-template-columns: 1fr; /* estrechas: 1 columna */
  }
}
@media (min-width: 900px) {
  .ragnarok.sheet .skills-grid-3x2 {
    grid-template-columns: repeat(3, 1fr); /* amplias: 3 columnas */
  }
}

.ragnarok.sheet .skills-cell {
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  padding: var(--gap-md);
  display: grid;
  grid-template-rows: auto 1fr;
  gap: var(--gap-md);
}
.ragnarok.sheet .skills-cell-header {
  font-weight: 800; /* más peso */
  font-size: 1.05rem; /* un poco más grande */
  text-transform: uppercase; /* jerarquía clara */
  letter-spacing: 0.6px;
  color: #fff; /* mayor contraste */
  background: linear-gradient(to right, rgba(231, 76, 60, 0.12), transparent 60%);
  border-bottom: 1px solid var(--color-border);
  border-left: 4px solid var(--color-accent); /* barra de acento */
  padding: 6px 8px 6px 10px; /* espacio interior extra */
  border-top-left-radius: var(--radius-sm);
  border-top-right-radius: var(--radius-sm);
}
/* Variante compacta si se desea menos altura (opcional, aplicar por clase) */
.ragnarok.sheet .skills-cell-header.is-compact {
  font-size: 1rem;
  padding: 4px 6px 4px 10px;
}


/* Lista de habilidades dentro de cada celda */
.ragnarok.sheet .skills-list {
  display: grid;
  gap: var(--gap-sm);
}
.ragnarok.sheet .skill-row {
  display: grid;
  grid-template-columns: 1fr 110px; /* nombre + input */
  gap: var(--gap-md);
  align-items: center;
}
@media (min-width: 520px) {
  .ragnarok.sheet .skill-row {
    grid-template-columns: 1fr 130px;
  }
}

/* =========================
   Hoja de trasfondo (texto)
   ========================= */
.ragnarok.sheet .lore-grid {
  display: grid;
  grid-template-columns: 1fr 1fr; /* 2 columnas en pantallas medias/grandes */
  gap: var(--gap-xl);
  margin-top: var(--gap-xl);
}
@media (max-width: 720px) {
  .ragnarok.sheet .lore-grid {
    grid-template-columns: 1fr; /* 1 columna en pantallas estrechas */
  }
}
.ragnarok.sheet .lore-card {
  background: var(--color-surface-2);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  padding: var(--gap-md);
  box-shadow: 0 0 8px var(--color-accent-shadow);
  display: grid;
  grid-template-rows: auto 1fr;
  gap: var(--gap-sm);
}
.ragnarok.sheet .lore-card h3 {
  margin: 0;
  text-align: left; /* títulos de sección alineados a la izquierda */
}
.ragnarok.sheet .lore-text {
  width: 100%;
  min-height: 160px;
  resize: vertical;
  box-sizing: border-box;
  background: #101010;
  color: #f5f5f5;
  border: 1px solid #343434;
  border-radius: var(--radius-sm);
  padding: 8px 10px;
  line-height: 1.4;
}
.ragnarok.sheet .lore-text:focus {
  outline: none;
  border-color: var(--color-accent);
  box-shadow: 0 0 6px var(--color-accent-weak);
}
/* Variante a pantalla completa si se requiere ocupar alto disponible de la tarjeta */
.ragnarok.sheet .lore-card.lore-flex .lore-text {
  min-height: 240px;
}
/* Nombres de habilidades: destacar más los labels */
.ragnarok.sheet .skill-name {
  cursor: pointer;
  text-decoration: underline dotted;
  color: #ffd9d9;
  font-weight: 700; /* refuerzo de jerarquía */
  letter-spacing: 0.2px;
  text-shadow: 0 0 2px rgba(231, 76, 60, 0.2);
}
.ragnarok.sheet .skill-name:hover {
  text-decoration: underline;
  color: #ffffff;
  background: rgba(231, 76, 60, 0.06); /* leve realce en hover */
  border-radius: var(--radius-sm);
  padding: 2px 4px;
}

/* Distribución de cuatro áreas: Trasfondo, Secretos, Avistamientos y Notas
   Usa estas clases de ayuda si deseas controlar el orden en responsive */
.ragnarok.sheet .lore--trasfondo {}
.ragnarok.sheet .lore--secretos {}
.ragnarok.sheet .lore--avistamientos {}
.ragnarok.sheet .lore--notas {}
/* Banner superior */
.ragnarok.sheet .sheet-banner {
  --banner-height: 280px;   /* ajusta aquí la altura del banner */
  margin: 0 0 12px 0;
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  overflow: hidden;
  box-shadow: 0 0 8px var(--color-accent-shadow);
  background: var(--color-surface-2);
}
.ragnarok.sheet .sheet-banner img {
  display: block;
  width: 100%;
  height: var(--banner-height); /* fuerza la altura del contenedor */
  object-fit: cover;            /* escala y recorta para llenar sin deformar */
}


